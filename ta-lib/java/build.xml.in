<?xml version="1.0"?>
<project name="@PROJECT_NAME@" basedir="@TA_LIB_JAVA_BASEDIR@" default="build">
	<property name="debug" value="true"/>
	<property name="dir.src" value="src/"/>
	<property name="file.jar" value="@ta-lib_BINARY_DIR@/lib-java/@TA_LIB_JAR_TARGET_NAME@.jar"/>
	<property name="sources.jar" value="@ta-lib_BINARY_DIR@/lib-java/@TA_LIB_JAR_TARGET_NAME@-sources.jar" />
	<property name="test.jar" value="@ta-lib_BINARY_DIR@/lib-java/@TA_LIB_JAR_TARGET_NAME@-test.jar" />
	<property name="dir.classes" value="@ta-lib_BINARY_DIR@/java/classes"/>
	<property name="junit.jar" value="@JUNIT_JAR@"/>
	<path id="classpath.base">
		<pathelement location="${dir.src}"/>
		<pathelement location="${junit.jar}"/>
	</path>
	<path id="classpath.test">
		<pathelement location="${file.jar}"/>
		<pathelement location="${junit.jar}"/>
	</path>
	<target name="test" depends="build">
		<echo message="Running ${ant.project.name} tests"/>
		<junit>
			<classpath refid="classpath.test"/>
			<formatter type="brief" usefile="false"/>
			<test name="com.tictactec.ta.lib.test.AllTests"/>
		</junit>
	</target>
	<target name="build" description="Build ta-lib.">
		<echo message="Building project ${ant.project.name}"/>
		<mkdir dir="${dir.classes}"/>
		<copy todir="${dir.classes}" includeEmptyDirs="false">
			<fileset dir="${dir.src}" excludes="**/*.java"/>
		</copy>
		<javac srcdir="${dir.src}" destdir="${dir.classes}" debug="${debug}">
			<classpath refid="classpath.base"/>
		</javac>
		<delete file="${file.jar}"/>
		<jar destfile="${file.jar}" 
			basedir="${dir.classes}"
			excludes="com/tictactec/ta/lib/test/*.class"/>

		<jar destfile="${test.jar}" basedir="${dir.classes}" />

		<jar destfile="${sources.jar}" 
			basedir="${dir.src}" excludes="**/*.class"/>
	</target>
	<target name="clean" description="clean up all generated files.">
		<echo message="Cleaning up project ${ant.project.name}"/>
		<delete dir="${dir.classes}"/>
		<delete file="${file.jar}"/>
		<delete file="${test.jar}"/>
		<delete file="${sources.jar}"/>
	</target>
</project>
